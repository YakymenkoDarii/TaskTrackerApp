@using TaskTrackerApp.Frontend.Domain.DTOs.Cards

<MudPaper Class="pa-3 d-flex align-center gap-3 cursor-pointer hover-effect mb-2"
          Elevation="0"
          Outlined="true"
          @onclick="@(() => OnTaskClick.InvokeAsync(Task))">

    <div @onclick:stopPropagation>
        <MudTooltip Text="@(Task.IsCompleted ? "Mark incomplete" : $"Priority: {Task.Priority}")">
            <MudIconButton Icon="@(Task.IsCompleted? Icons.Material.Filled.CheckCircle : Icons.Material.Outlined.Circle)"
                           Color="@(Task.IsCompleted ? Color.Success : GetPriorityColor(Task.Priority))"
                           Size="Size.Medium"
                           OnClick="@(() => OnToggleComplete.InvokeAsync(Task))"
                           Class="m-0" />
        </MudTooltip>
    </div>

    <div class="d-flex flex-column flex-grow-1" style="min-width: 0;">
        <MudText Typo="Typo.body2"
                 Style="@(Task.IsCompleted ? "text-decoration: line-through; color: gray;" : "")">
            @Task.Title
        </MudText>

        <div class="d-flex align-center gap-2 mt-1">
            <MudText Typo="Typo.caption" Class="mud-text-secondary" Style="font-size: 0.75rem;">
                @Task.BoardTitle
            </MudText>

            @if (Task.DueDate.HasValue)
            {
                <MudText Typo="Typo.caption" Color="@(IsOverdue(Task) ? Color.Error : Color.Default)">
                    • @Task.DueDate.Value.ToString("t")
                </MudText>
            }
        </div>
    </div>

    <MudIcon Icon="@Icons.Material.Filled.ChevronRight" Size="Size.Small" Class="mud-text-disabled" />
</MudPaper>